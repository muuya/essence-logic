# æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒå¯¹è¯è®°å½•

åœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆéƒ¨ç½²çš„ç½‘é¡µï¼‰ä¸Šæé—®åï¼Œå¯¹è¯è®°å½•ä¼šä¿å­˜åœ¨æœåŠ¡å™¨çš„ `data/chat_history.json` æ–‡ä»¶ä¸­ã€‚æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•æŸ¥çœ‹è¿™äº›è®°å½•ã€‚

## é‡è¦è¯´æ˜

**æ•°æ®å­˜å‚¨ä½ç½®ï¼š**
- ç”Ÿäº§ç¯å¢ƒï¼šå¯¹è¯è®°å½•ä¿å­˜åœ¨**æœåŠ¡å™¨çš„** `data/chat_history.json` æ–‡ä»¶ä¸­
- æœ¬åœ°ï¼šæ— æ³•ç›´æ¥è®¿é—®æœåŠ¡å™¨æ–‡ä»¶

**æŸ¥çœ‹æ–¹å¼ï¼š**
- é€šè¿‡ API ç«¯ç‚¹ï¼ˆéœ€è¦è®¤è¯ï¼‰
- é€šè¿‡éƒ¨ç½²å¹³å°çš„æ–‡ä»¶ç®¡ç†åŠŸèƒ½ï¼ˆå¦‚æœæœ‰ï¼‰

## æ–¹æ³•ä¸€ï¼šé€šè¿‡ API æŸ¥çœ‹ï¼ˆæ¨èï¼‰

### è·å–è®¿é—®ä»¤ç‰Œ

è®¿é—®ä»¤ç‰Œå°±æ˜¯ä½ çš„ `AI_BUILDER_TOKEN` ç¯å¢ƒå˜é‡å€¼ã€‚

**æœ¬åœ°æŸ¥çœ‹ï¼š**
```bash
# æŸ¥çœ‹ .env æ–‡ä»¶ä¸­çš„ token
cat .env | grep AI_BUILDER_TOKEN
```

### è®¿é—®å¯¹è¯è®°å½• API

**åŸºæœ¬ç”¨æ³•ï¼š**
```bash
# è·å–æœ€è¿‘ 50 æ¡è®°å½•
curl "https://essence-logic.ai-builders.space/api/chat/history?token=YOUR_TOKEN"

# è·å–æœ€è¿‘ 20 æ¡è®°å½•
curl "https://essence-logic.ai-builders.space/api/chat/history?token=YOUR_TOKEN&limit=20"

# åˆ†é¡µè·å–ï¼ˆè·³è¿‡å‰10æ¡ï¼Œè·å–20æ¡ï¼‰
curl "https://essence-logic.ai-builders.space/api/chat/history?token=YOUR_TOKEN&limit=20&offset=10"
```

**åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š**
```
https://essence-logic.ai-builders.space/api/chat/history?token=YOUR_TOKEN
```

âš ï¸ **å®‰å…¨æç¤ºï¼š** Token ä¼šå‡ºç°åœ¨ URL ä¸­ï¼Œå»ºè®®ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è€Œä¸æ˜¯æµè§ˆå™¨ã€‚

### ä½¿ç”¨ Python è„šæœ¬æŸ¥çœ‹

åˆ›å»º `view_production_chat.py`ï¼š

```python
#!/usr/bin/env python3
"""æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒçš„å¯¹è¯è®°å½•"""

import os
import requests
import json
from dotenv import load_dotenv

# åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv()

TOKEN = os.getenv("AI_BUILDER_TOKEN")
API_URL = "https://essence-logic.ai-builders.space/api/chat/history"

def view_chat_history(limit=20):
    """æŸ¥çœ‹å¯¹è¯è®°å½•"""
    if not TOKEN:
        print("âŒ é”™è¯¯: æœªè®¾ç½® AI_BUILDER_TOKEN ç¯å¢ƒå˜é‡")
        return
    
    params = {
        "token": TOKEN,
        "limit": limit
    }
    
    try:
        response = requests.get(API_URL, params=params)
        response.raise_for_status()
        
        data = response.json()
        records = data.get("records", [])
        total = data.get("total", 0)
        
        print(f"ğŸ“Š æ€»å…± {total} æ¡è®°å½•ï¼Œæ˜¾ç¤ºæœ€è¿‘ {len(records)} æ¡\n")
        print("=" * 80)
        
        for i, record in enumerate(records, 1):
            timestamp = record.get('timestamp', '')
            user_msg = record.get('user_message', '')[:100]
            assistant_msg = record.get('assistant_message', '')[:200]
            
            print(f"\n[{i}] {timestamp}")
            print(f"ç”¨æˆ·: {user_msg}{'...' if len(record.get('user_message', '')) > 100 else ''}")
            print(f"AI: {assistant_msg}{'...' if len(record.get('assistant_message', '')) > 200 else ''}")
            print("-" * 80)
            
    except requests.exceptions.RequestException as e:
        print(f"âŒ è¯·æ±‚å¤±è´¥: {e}")

if __name__ == "__main__":
    import sys
    limit = int(sys.argv[1]) if len(sys.argv) > 1 else 20
    view_chat_history(limit)
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
python view_production_chat.py 10  # æŸ¥çœ‹æœ€è¿‘10æ¡
```

## æ–¹æ³•äºŒï¼šé€šè¿‡éƒ¨ç½²å¹³å°æŸ¥çœ‹

å¦‚æœéƒ¨ç½²å¹³å°ï¼ˆAI Builders Space / Koyebï¼‰æä¾›æ–‡ä»¶ç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼š

1. ç™»å½•éƒ¨ç½²å¹³å°
2. æ‰¾åˆ°æ–‡ä»¶ç®¡ç†åŠŸèƒ½
3. æŸ¥çœ‹ `data/chat_history.json` æ–‡ä»¶

## æ–¹æ³•ä¸‰ï¼šå¯¼å‡ºæ•°æ®

ä½¿ç”¨ API å¯¼å‡ºæ‰€æœ‰æ•°æ®ï¼š

```python
import requests
import json
import os
from dotenv import load_dotenv

load_dotenv()

TOKEN = os.getenv("AI_BUILDER_TOKEN")
API_URL = "https://essence-logic.ai-builders.space/api/chat/history"

# è·å–æ‰€æœ‰è®°å½•ï¼ˆåˆ†æ‰¹è·å–ï¼‰
all_records = []
offset = 0
limit = 100

while True:
    params = {"token": TOKEN, "limit": limit, "offset": offset}
    response = requests.get(API_URL, params=params)
    data = response.json()
    records = data.get("records", [])
    
    if not records:
        break
    
    all_records.extend(records)
    offset += limit
    
    if len(records) < limit:
        break

# ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶
with open("chat_history_export.json", "w", encoding="utf-8") as f:
    json.dump(all_records, f, ensure_ascii=False, indent=2)

print(f"âœ… å·²å¯¼å‡º {len(all_records)} æ¡è®°å½•åˆ° chat_history_export.json")
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ä¿æŠ¤ Token**
   - ä¸è¦å°† Token æäº¤åˆ° Git
   - ä¸è¦åœ¨å…¬å¼€åœºåˆåˆ†äº« Token
   - ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨ Token

2. **è®¿é—®é™åˆ¶**
   - API ç«¯ç‚¹éœ€è¦æ­£ç¡®çš„ Token æ‰èƒ½è®¿é—®
   - å»ºè®®å®šæœŸæ›´æ¢ Token

3. **æ•°æ®éšç§**
   - å¯¹è¯è®°å½•åŒ…å«ç”¨æˆ·çš„å®é™…é—®é¢˜
   - è¯·å¦¥å–„ä¿ç®¡ï¼Œéµå®ˆéšç§ä¿æŠ¤è§„å®š

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæœ¬åœ°çœ‹ä¸åˆ°ç”Ÿäº§ç¯å¢ƒçš„å¯¹è¯è®°å½•ï¼Ÿ

A: å› ä¸ºæ•°æ®ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¸åœ¨æœ¬åœ°ã€‚éœ€è¦é€šè¿‡ API æˆ–éƒ¨ç½²å¹³å°è®¿é—®ã€‚

### Q: å¦‚ä½•çŸ¥é“ Token æ˜¯ä»€ä¹ˆï¼Ÿ

A: Token å°±æ˜¯ `AI_BUILDER_TOKEN` ç¯å¢ƒå˜é‡çš„å€¼ï¼Œå¯ä»¥åœ¨ `.env` æ–‡ä»¶ä¸­æŸ¥çœ‹ã€‚

### Q: å¯ä»¥åˆ é™¤å¯¹è¯è®°å½•å—ï¼Ÿ

A: ç›®å‰æ²¡æœ‰åˆ é™¤ APIï¼Œå¦‚æœéœ€è¦åˆ é™¤ï¼Œéœ€è¦ï¼š
1. é€šè¿‡éƒ¨ç½²å¹³å°è®¿é—®æœåŠ¡å™¨æ–‡ä»¶
2. æˆ–è€…æ·»åŠ åˆ é™¤åŠŸèƒ½ï¼ˆéœ€è¦é¢å¤–å¼€å‘ï¼‰

### Q: å¯¹è¯è®°å½•ä¼šä¿å­˜å¤šä¹…ï¼Ÿ

A: ç³»ç»Ÿæœ€å¤šä¿ç•™æœ€è¿‘ 1000 æ¡è®°å½•ï¼Œè¶…è¿‡ä¼šè‡ªåŠ¨åˆ é™¤æ—§è®°å½•ã€‚

## æ€»ç»“

**æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒå¯¹è¯è®°å½•çš„æ­¥éª¤ï¼š**

1. è·å– `AI_BUILDER_TOKEN`ï¼ˆåœ¨ `.env` æ–‡ä»¶ä¸­ï¼‰
2. ä½¿ç”¨ API è®¿é—®ï¼š`https://essence-logic.ai-builders.space/api/chat/history?token=YOUR_TOKEN`
3. æˆ–ä½¿ç”¨ Python è„šæœ¬æ›´æ–¹ä¾¿åœ°æŸ¥çœ‹

**æ¨èæ–¹å¼ï¼š** ä½¿ç”¨ Python è„šæœ¬ï¼Œæ›´å®‰å…¨ã€æ›´æ–¹ä¾¿ã€‚
